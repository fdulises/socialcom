function activarSlideshow(){new jcslideshow({ulslideshow:"#JCSlideshow",bsiguiente:"#JCSbtna",banterior:"#JCSbtnb"})}function selectorMultiple(e,t){var i=document.querySelectorAll(e);Object.keys(i).map(function(e){t(e,i)})}function addEvent(e,t,i){selectorMultiple(e,function(e,o){o[e].addEventListener(t,i)})}function removeEvent(e,t,i){selectorMultiple(e,function(e,o){o[e].removeEventListener(t,i)})}function ToSeoUrl(e){var t=e.toString().toLowerCase();return t=t.split(/\&+/).join("-and-"),t=t.split(/[^a-z0-9]/).join("-"),t=t.split(/-+/).join("-"),t=t.trim("-")}function dataToogle(e){function t(e){var t=document.querySelector(e.getAttribute("data-destino"));e.checked?t.setAttribute("data-estado","show"):t.setAttribute("data-estado","hide")}var o=document.querySelectorAll(e),a=o.length;for(i=0;i<a;i++)t(o[i]),o[i].addEventListener("change",function(){t(this)})}function ckeditorUpdate(){for(instance in CKEDITOR.instances)CKEDITOR.instances[instance].updateElement()}function txtCopy(e){var t=document.createElement("input");t.setAttribute("value",document.querySelector(e).innerHTML),document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}function publicComentDel(e){var t=e.getAttribute("data-publicdel");listefi.confirm("Desea eliminar esta publicación de forma permanente?",function(e){e&&listefi.ajax({url:"?public_del&id="+t,method:"get",success:function(e){1==(e=JSON.parse(e)).estado?(document.querySelector('[data-id="'+t+'"].comentario_li').style.display="none",listefi.alert("Publicación eliminada correctamente","Exito")):listefi.alert("No se ha podido eliminar la publicación","Error")}})})}var jcslideshow=function(e){var t=e.ulslideshow||!1,o=e.banterior,a=e.bsiguiente,n=e.intervalo||5,r=document.querySelector(o),c=document.querySelector(a),s=document.querySelector(t),l={},u=0,d=0,m=function(){if(d==u-1)e=0;else var e=d+1;for(i=0;i<u;i++)l[i].style.opacity=e==i?1:0;d=e},f=function(){if(0==d)e=u-1;else var e=d-1;for(i=0;i<u;i++)l[i].style.opacity=e==i?1:0;d=e},v=function(){jcstiempo=setInterval(m,1e3*n)},p=function(){window.clearInterval(jcstiempo)};(function(){l=s.querySelectorAll("li"),u=l.length})(),v(),r.addEventListener("click",m,!1),c.addEventListener("click",f,!1),s.addEventListener("mouseover",p,!1),s.addEventListener("mouseout",v,!1)},imgupload=function(e){e.filein=document.querySelector(e.filein),e.container=document.querySelector(e.container),e.filein.addEventListener("change",function(){e.container.innerHTML="";var t=this.files.length;for(i=0;i<t;i++){var o=this.files[i];if(o.type.match(/image.*/)){var a=new FileReader;a.onloadend=function(t){var i=document.createElement("img");i.src=t.target.result,e.container.appendChild(i)},a.readAsDataURL(o)}}})};document.addEventListener("DOMContentLoaded",function(){function e(){O.checked?(T.setAttribute("data-estado","hide"),k.setAttribute("data-estado","show")):(T.setAttribute("data-estado","show"),k.setAttribute("data-estado","hide"))}function t(){var e=document.querySelector("#cover");x.innerHTML="",q.innerHTML="",e.value="",""!=A.value&&((e=document.createElement("img")).src=A.value,x.appendChild(e))}function o(){var e=this,t=e.getAttribute("data-tipo"),i=e.getAttribute("data-id");listefi.ajax({url:"?like="+i+"&tipo="+t,method:"get",success:function(i){i=JSON.parse(i),M.innerHTML=parseInt(M.innerHTML)+parseInt(t),removeEvent(".likebtn","click",o),1==t?e.setAttribute("data-estado","success"):e.setAttribute("data-estado","error")}})}function a(){var e=parseInt(this.value);e<0&&(this.value=1),e>J&&(this.value=J)}function n(e){listefi.confirm(e.msg,function(t){t&&listefi.ajax({url:"?denunciar="+e.destino+"&tipo="+e.tipo,method:"get",success:e.success})})}function r(){var e=this;n({msg:"Realmente desea denunciar este comentario?",destino:this.getAttribute("data-id"),tipo:2,success:function(t){listefi.alert("Se ha envidado tu denuncia!","Éxito"),e.removeEventListener("click",r)}})}function c(){var e=Y.value;e==G.value?listefi.ajax({url:"?cuenta_clave",method:"post",data:{clave:hex_sha512(e)},success:function(e){1==(e=JSON.parse(e)).estado?listefi.alert("<p>Se ha guardado tu nueva contraseña</p>","Éxito",function(){document.location.href=SITIO_URL+"/acceso"}):listefi.alert("<p>Ocurrio un error al procesar la solicitud.</p><p>Intentalo de nuevo.</p>","Error")}}):listefi.alert("<p>Los campos de contraseña no coinciden.</p><p>Intentalo de nuevo.</p>","Error")}function s(){var e=this.getAttribute("data-publicdel");listefi.confirm("Desea eliminar esta publicación de forma permanente?",function(t){t&&listefi.ajax({url:"?public_del&id="+e,method:"get",success:function(t){1==(t=JSON.parse(t)).estado?(document.querySelector("#publicel_"+e).style.display="none",listefi.alert("Publicación eliminada correctamente","Exito")):listefi.alert("No se ha podido eliminar la publicación","Error")}})})}function l(){var e=this.getAttribute("data-id"),t=this;listefi.ajax({url:"?follow="+e,method:"get",success:function(e){d(t)}})}function u(){var e=this.getAttribute("data-id"),t=this;listefi.ajax({url:"?unfollow="+e,method:"get",success:function(e){m(t)}})}function d(e){e.removeEventListener("click",l),e.setAttribute("data-follow",1),b(e)}function m(e){e.removeEventListener("click",u),e.removeEventListener("mouseover",f),e.removeEventListener("mouseout",v),e.setAttribute("data-follow",0),p(e)}function f(){this.innerHTML="Dejar de seguir"}function v(){this.innerHTML="Siguiendo"}function p(e){e.innerHTML="Seguir",e.addEventListener("click",l)}function b(e){e.innerHTML="Siguiendo",e.addEventListener("mouseover",f),e.addEventListener("mouseout",v),e.addEventListener("click",u)}function h(e){var t=e.getAttribute("data-id");listefi.ajax({url:"?fotodel="+t,method:"get",success:function(e){1==(e=JSON.parse(e)).estado?document.querySelector("[data-id='"+t+"'].fotos-element").style.display="none":listefi.alert("La imágen no se pudo eliminar","Error")}})}function g(e){var t=e.pagina||0,i=e.superior||0;listefi.ajax({url:SITIO_URL+"/public_coment?id="+i+"&p="+t,method:"get",success:e.callback})}function S(){listefi.confirm("Realmente desea denunciar este usuario?",function(e){e&&listefi.ajax({url:"?denunciar="+Z.getAttribute("data-id")+"&tipo=3",method:"get",success:function(e){listefi.alert("Se ha envidado tu denuncia!","Éxito"),Z.removeEventListener("click",S)}})})}new LazyLoad;baguetteBox.run(".imglbg",{animation:"fadeIn",noScrollbars:!0});var E=document.querySelectorAll("select[data-selected]");if(Object.keys(E).map(function(e){var t=E[e].getAttribute("data-selected"),i=E[e].querySelector('option[value="'+t+'"]');i&&i.setAttribute("selected","")}),document.querySelector("#actionNav").addEventListener("click",function(){var e=this,t=document.querySelector("#sup-nav");"open"==e.getAttribute("data-estado")?(e.setAttribute("data-estado","close"),t.setAttribute("data-estado","close")):(e.setAttribute("data-estado","open"),t.setAttribute("data-estado","open"))}),document.querySelector("#nav-search-btn").addEventListener("click",function(){var e=this,t=document.querySelector("#nav-search-in");"open"==e.getAttribute("data-estado")?(e.setAttribute("data-estado","close"),t.setAttribute("data-estado","close")):(e.setAttribute("data-estado","open"),t.setAttribute("data-estado","open"))}),/post=1/.test(window.location)?listefi.alert("Tu entrada ha sido enviada y pronto sera visible","Éxito"):/error=no_donacion/.test(window.location)&&listefi.alert("No tienes suficientes puntos para donar","Error"),"post"==SITIO_SEC){var y=document.querySelector("#post_editor"),_=document.querySelector("#cover"),L=document.querySelector("#form-img-btn"),q=document.querySelector("#form-img-box"),x=document.querySelector("#form-imgurl-box"),A=document.querySelector("#cover_url"),O=document.querySelector("#imgurl_s"),T=document.querySelector("#cover_cont"),k=document.querySelector("#cover_cont_url"),I=document.querySelector("#puntosv"),j=document.querySelector("#puntos_s"),w=document.querySelector("#titulo"),C=document.querySelector("#url");w.addEventListener("blur",function(){this.value&&!C.value&&(C.value=ToSeoUrl(this.value))}),""!=A.value&&O.setAttribute("checked","checked"),0!=I.value&&j.setAttribute("checked","checked"),e(),O.addEventListener("change",e),dataToogle(".dataToogle"),t(),A.addEventListener("blur",t),_.addEventListener("change",function(){q.innerHTML="",x.innerHTML="",A.value="";var e=this.files.length;for(i=0;i<e;i++){var t=this.files[i];if(t.type.match(/image.*/)){var o=new FileReader;o.onloadend=function(e){var t=document.createElement("img");t.src=e.target.result,q.appendChild(t)},o.readAsDataURL(t)}}}),L.addEventListener("click",function(){_.click()}),y.addEventListener("submit",function(e){e.preventDefault(),ckeditorUpdate(),listefi.ajax({method:this.method,url:this.action,data:new FormData(this),success:function(e){if(1==(e=JSON.parse(e)).estado)document.location.href=SITIO_URL+"?post=1";else{var t="";-1!=e.error.indexOf("titulo_vacio")&&(t+="<li>El titulo no puede estar vacio</li>"),-1!=e.error.indexOf("url_vacio")&&(t+="<li>El slug no puede estar vacio</li>"),-1!=e.error.indexOf("cover_error")&&(t+="<li>Error al agregar la imagen de portada</li>"),listefi.alert("<ul>"+t+"</ul>","Tienes algunos errores")}}})})}else if(IS_ENTRADA){document.querySelector("#scrollto_coment").addEventListener("click",function(){listefi.scrollTo(document.querySelector("#coment_form_box").offsetTop,1e3,!1)});var N=document.querySelector("#coment_form");N||(N=document.createElement("div")),N.addEventListener("submit",function(e){e.preventDefault(),listefi.ajax({method:"post",url:"?comentar",data:{autor:this.autor.value,email:this.email.value,contenido:this.contenido.value},success:function(e){if(1==(e=JSON.parse(e)).estado)N.reset(),listefi.alert("Tu comentario ha sido enviado y pasara por revisión antes de ser publicado.","Comentario enviado");else{var t="";-1!=e.error.indexOf("autor_vacio")&&(t+="<li>Tienes que escribir tu nombre.</li>"),-1!=e.error.indexOf("demasiados_comentarios")&&(t+="<li>No puedes enviar tantos comentarios de forma seguida, intentalo unos minutos más tarde.</li>"),-1==e.error.indexOf("email_vacio")&&-1==e.error.indexOf("email_incorrecto")||(t+="<li>El E-mail ingresado es incorrecto.</li>"),-1!=e.error.indexOf("contenido_vacio")&&(t+="<li>No puedes enviar un comentario vacio.</li>"),listefi.alert("<ul>"+t+"</ul>","Comentario Rechazado")}}})});var D=document.querySelector("#coment_member_form");D||(D=document.createElement("div")),D.addEventListener("submit",function(e){e.preventDefault(),listefi.ajax({method:"post",url:"?comentar",data:{contenido:this.contenido.value},success:function(e){if(1==(e=JSON.parse(e)).estado)D.reset(),listefi.alert("Tu comentario ha sido enviado y pasara por revisión antes de ser publicado.","Comentario enviado");else{var t="";-1!=e.error.indexOf("demasiados_comentarios")&&(t+="<li>No puedes enviar tantos comentarios de forma seguida, intentalo unos minutos más tarde.</li>"),-1!=e.error.indexOf("contenido_vacio")&&(t+="<li>No puedes enviar un comentario vacio.</li>"),listefi.alert("<ul>"+t+"</ul>","Comentario Rechazado")}}})});var M=document.querySelector("#totallikes");addEvent(".likebtn","click",o);var H=document.querySelector("#post_usopt_puntos"),R=document.querySelector("#puntos_in"),J=parseInt(H.getAttribute("data-maxp"));R.addEventListener("change",a),R.addEventListener("blur",a),H.addEventListener("submit",function(e){e.preventDefault();var t=this.getAttribute("data-id"),i=this.cantidad.value;listefi.ajax({url:"?puntear="+t+"&cantidad="+i,method:"get",success:function(e){}}),this.innerHTML='<div class="alert alert-info"><span class="icon-info"></span> Puntos Agregados</div>'});var F=document.querySelector("#denun_in");F.addEventListener("click",function(){n({msg:"Realmente desea denunciar esta entrada?",destino:this.getAttribute("data-id"),tipo:1,success:function(e){listefi.alert("Se ha envidado tu denuncia!","Éxito"),F.removeEventListener("click",n)}})}),addEvent(".coment_denuncia","click",r);var U=document.querySelector("#btn-deleteEntrada");U&&U.addEventListener("click",function(){var e=this.getAttribute("data-id");listefi.confirm("Realmente desea eliminar esta entrada?",function(t){t&&listefi.ajax({url:"?eliminar="+e,method:"get",success:function(e){1==(e=JSON.parse(e)).estado?listefi.alert("La entrada ha sido eliminada!","Éxito"):listefi.alert("No se pudo eliminar la entrada","Error")}})})})}else if("busqueda"==SITIO_SEC){var P=document.querySelector("#cont-fbusq"),z=document.querySelector("#filtro_orden"),B=document.location,K="";/order=likes/.test(B)?K="likes":/order=recientes/.test(B)?K="recientes":/order=hits/.test(B)?K="hits":/order=puntosv/.test(B)&&(K="puntosv"),""!=K&&document.querySelector('option[value="'+K+'"]').setAttribute("selected",""),z.addEventListener("change",function(){P.submit()})}else if("cuenta"==SITIO_SEC){document.querySelector("#cuenta_editor").addEventListener("submit",function(e){e.preventDefault(),listefi.ajax({method:this.method,url:this.action,data:new FormData(this),success:function(e){if(1==(e=JSON.parse(e)).estado)listefi.alert("Tus datos se han actualizado correctamente","Éxito");else{var t="";-1!=e.error.indexOf("email_incorrecto")&&(t+="<li>El E-mail ingresado es incorrecto</li>"),-1!=e.error.indexOf("avatar_incorrecto")&&(t+="<li>Error al subir el avatar seleccionado (Puede que el formato sea incorrecto o la imagen muy pequeña)</li>"),-1!=e.error.indexOf("cover_incorrecto")&&(t+="<li>Error al subir la imagen de portada (Puede que el formato sea incorrecto o la imagen muy pequeña)</li>"),-1!=e.error.indexOf("facebook_incorrecto")&&(t+="<li>El campo Facebook es incorrecto</li>"),listefi.alert("<ul>"+t+"</ul>","Tienes algunos errores")}}})}),selectorMultiple(".form-upload[data-imgsource]",function(e,t){var i=document.createElement("img");i.src=t[e].getAttribute("data-imgsource"),t[e].appendChild(i)}),addEvent("button[data-upload-source]","click",function(){var e=document.querySelector(this.getAttribute("data-upload-source"));e&&e.click()}),imgupload({filein:"#avatar",container:"#form-avatar-box"}),imgupload({filein:"#cover",container:"#form-cover-box"});var Y=document.querySelector("#usuario_clave"),G=document.querySelector("#usuario_reclave");document.querySelector("#usuario_btnclave").addEventListener("click",function(){var e="<p>Para cambiar la contraseña es necesario cerrar la sesión actual.</p>";e+="<p>Realmente desea continuar?</p>",listefi.confirm(e,function(e){e&&c()})})}else if("perfil"==SITIO_SEC){document.querySelector("#superior").setAttribute("data-seccion","perfil"),addEvent("button[data-publicdel]","click",s);var Q=document.querySelector("#public_set")||document.createElement("div");Q.addEventListener("submit",function(e){function t(e){return'<div id="publicel_'+e.public_id+'" class="mg-sec cont-white"><div class="container"><div class="gd-20"><img class="coment_avatar" src="'+e.public_avatar+'"></div><div class="gd-80">\t<div class="coment_autor"><a href="'+SITIO_URL+"/@"+e.public_autor+'">@'+e.public_autor+'</a></div><div class="coment_fecha">'+e.public_fecha+'</div><div class="coment_cont">'+e.public_contenido+'</div></div><div class="gd-100 tx-right"><button class="btn btn-default size-s" data-publicdel="'+e.public_id+'"><span class="icon-blocked"></span>Eliminar</button></div></div></div>'}e.preventDefault();var i=this.getAttribute("data-superior"),o=this.publi_content.value;if(""==o)return 0;listefi.ajax({url:this.action,method:this.method,data:{superior:i,contenido:o},success:function(e){if(1==(e=JSON.parse(e)).estado){Q.reset();var i=t(e.data),o=document.querySelector("#recentPubli");o.innerHTML=i+o.innerHTML,addEvent('button[data-publicdel="'+e.data.public_id+'"]',"click",s)}}})}),addEvent(".form_public_set","submit",function(e){e.preventDefault();var t=this,i=this.getAttribute("data-superior"),o=this.publi_content.value;if(""==o)return 0;listefi.ajax({url:this.action,method:this.method,data:{superior:i,contenido:o},success:function(e){1==(e=JSON.parse(e)).estado?(t.reset(),listefi.alert("Comentario enviado","Éxito")):listefi.alert("No sabemos que paso","Oops!")}})}),selectorMultiple("button[data-follow]",function(e,t){0==t[e].getAttribute("data-follow")?p(t[e]):b(t[e])});var V=document.querySelectorAll("button[data-followbtn]");2==V.length&&(V[0].addEventListener("click",function(){0==this.getAttribute("data-follow")?d(V[1]):m(V[1])}),V[1].addEventListener("click",function(){0==this.getAttribute("data-follow")?d(V[0]):m(V[0])}));var W=document.querySelector("#form-fotoupload");if(W){imgupload({filein:"#foto",container:"#prevFoto"});var X=document.querySelector("#foto");document.querySelector("#perfilFotoSubidaBtn").addEventListener("click",function(){X.click()}),W.addEventListener("submit",function(e){e.preventDefault(),listefi.ajax({method:this.method,url:this.action,data:new FormData(this),success:function(e){if(1==(e=JSON.parse(e)).estado){var t=document.createElement("div");t.setAttribute("class","gd-25 fotos-element"),t.setAttribute("data-id",e.data.id);var i=document.createElement("img");i.src=e.data.url,t.appendChild(i),document.querySelector("#fotos-cont").appendChild(t),document.querySelector("#prevFoto").innerHTML="",W.reset()}else{var o="";-1!=e.error.indexOf("permitted_pics")?o+="<li>Has alcanzado el limite de fotos para tu nivel</li>":-1!=e.error.indexOf("error_subida")?o+="<li>Ocurrio un error al subir el archivo</li>":-1!=e.error.indexOf("error_type")?o+="<li>El formato de la imágen no es valido</li>":-1!=e.error.indexOf("error_size")?o+="<li>La imágen es damasiado grande</li>":o+="<li>Ocurrio un error al procesar la petición, por favor intenta de nuevo más tarde</li>",listefi.alert("<ul>"+o+"</ul>","Tienes algunos errores")}}})}),addEvent(".btndelete-cont button","click",function(){var e=this;listefi.confirm("Realmente quieres eliminar esta imágen?",function(t){t&&h(e)})})}addEvent(".coment_btn","click",function(){var e=this.getAttribute("data-superior"),t=this.getAttribute("data-destino"),i=(t=document.querySelector(t)).getAttribute("data-state"),o=parseInt(t.getAttribute("data-pagina"));o||(g({pagina:o,superior:e,callback:function(t){document.querySelector(".public_coment_list[data-superior='"+e+"']").innerHTML=t}}),t.setAttribute("data-pagina",1)),"closed"==i?t.setAttribute("data-state","open"):t.setAttribute("data-state","closed")});var Z=document.querySelector("#perfil_denuncia");Z.addEventListener("click",S)}else if("tienda"==SITIO_SEC)addEvent(".btncomprar","click",function(){function e(e){listefi.ajax({url:"?comprar="+e,method:"get",success:function(e){if(1==(e=JSON.parse(e)).estado)listefi.alert("El item se ha añadido a tu perfil","Éxito"),a.innerHTML=n-o;else{var t="";-1!=e.error.indexOf("puntos_insuficientes")?t="No cuentas con suficientes puntos":-1!=e.error.indexOf("producto_comprado")?t="Ya has comprado este producto":-1!=e.error.indexOf("producto_inexistente")&&(t="Error al intar comprar el producto"),listefi.alert(t,"Error")}}})}var t=this,i=t.getAttribute("data-id"),o=parseInt(t.getAttribute("data-precio")),a=document.querySelector("#user-puntos"),n=parseInt(a.innerHTML),r="<p>Desea adquirir este producto?</p>";r+="<p><strong>Precio:</strong> "+o+"</p>",r+="<p><strong>Puntos:</strong> "+n+"</p>",listefi.confirm(r,function(t){t&&e(i)})});else if("contacto"==SITIO_SEC){var $=document.querySelector("#contactform");$.addEventListener("submit",function(e){e.preventDefault(),listefi.ajax({url:this.action,method:this.method,data:new FormData(this),success:function(e){if(1==(e=JSON.parse(e)).estado)listefi.alert("Tu mensaje ha sido enviado!","Éxito"),$.reset();else{var t="";-1!=e.error.indexOf("nombre_vacio")?t+="<li>Tienes que llenar el campo nombre</li>":-1!=e.error.indexOf("email_vacio")?t+="<li>Tienes que llenar el campo E-mail</li>":-1!=e.error.indexOf("asunto_vacio")?t+="<li>Tienes que llenar el campo asunto</li>":-1!=e.error.indexOf("mensaje_vacio")?t+="<li>Tienes que escribir algo en el mensaje</li>":t+="<li>Ocurrio un error al procesar la petición, por favor intenta de nuevo más tarde</li>",listefi.alert("<ul>"+t+"</ul>","Tienes algunos errores")}}})})}else if("pedidos"==SITIO_SEC){var ee=document.querySelector("#pedidosform");ee.addEventListener("submit",function(e){e.preventDefault(),this.nombre.value&&listefi.ajax({url:this.action,method:this.method,data:{nombre:this.nombre.value},success:function(e){1==e?listefi.alert("Tu pedido ha sido enviado","Éxito"):listefi.alert("No se pudo enviar tu pedido, intentar de nuevo más tarde","Error"),ee.reset()}})})}else"referidos"==SITIO_SEC&&document.querySelector("#btn_copy").addEventListener("click",function(){txtCopy("#copiar_enlace"),listefi.alert("Enlace copiado al portapapeles","Éxito")})});